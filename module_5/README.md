# Группа: DST-48

**Sergey Pinaev - binom1982@gmail.com**

# Проект №5. Выбираем авто

Ссылка на соревнование: [[SF-DST] Car Price prediction](https://www.kaggle.com/c/sf-dst-car-price-prediction)

<p align="center" width="100%">
  <img src="https://thumbs.dreamstime.com/b/choosing-car-confused-man-decides-what-to-choose-94260361.jpg" width="400"/>
</p>
<hr>

## Задача

Представьте, что вы работаете в компании, которая занимается продажей автомобилей с пробегом. Основная задача компании и ее менеджеров - максимально быстро находить выгодные предложения (проще говоря, купить ниже рынка, а продать дороже рынка).

Вам поставлена задача создать модель, которая будет предсказывать стоимость автомобиля по его характеристикам.
Если наша модель работает хорошо, то мы сможем быстро выявлять выгодные предложения (когда желаемая цена продавца ниже предсказанной рыночной цены). Это значительно ускорит работу менеджеров и повысит прибыль компании.

Так исторически сложилось, что компания изначально не собирала данные. Есть только небольшой датасет с историей продаж, которого для обучения модели будет явно мало. Его мы будем использовать для теста (В ЛидерБорде), остальное придется собрать самим…

## Описание датасета

1. **bodyType** - тип автомобиля
1. **brand** - название бренда
1. **car_url** - url объявления
1. **color** - цвет автомобиля
1. **complectation_dict** - словарь комплектации автомобиля
1. **description** - текстовое описание продавца
1. **engineDisplacement** - объем двигателя
1. **enginePower** - мощность двигателя
1. **equipment_dict** - словарь оборудования автомобиля
1. **fuelType** - тип топлива
1. **image** - url изображения автомобиля
1. **mileage** - пробег
1. **modelDate** - год выпуска модели
1. **model_info** - словарь информации об автомобиле
1. **model_name** - тип модели
1. **name** - харакетиристика конкретной модели
1. **numberOfDoors** - количество дверей
1. **parsing_unixtime** - дата парсинга данных
1. **priceCurrency** - тип валюты
1. **productionDate** - год производства автомобиля
1. **sell_id** - номер объявления
1. **super_gen** - словарь характеристик текущего поколения автомобиля
1. **vehicleConfiguration** - конфигурация автомобиля
1. **vehicleTransmission** - тип трансмиссии
1. **vendor** - регион производства автомобиля
1. **Владельцы** - количество владельцев
1. **Владение** - срок владения продавцом автомобиля
1. **ПТС** - флаг наличия ПТС
1. **Привод** - тип привода
1. **Руль** - тип рулья
1. **Состояние** - состояния автомобиля
1. **Таможня** -  флаг растаможки
1. **price** - цена

## Этапы работы над проектом

* Были спарсины свежие данные по всем маркам автомобилей с сайта avto.ru 
* Первичная обработка данных;
* Анализ распределения признаков. Замена пропусков;
* EDA
* Feature engineering;
* Корреляционный анализ;
* Отбор не коррелирующих переменных;
* Анализ признаков и устранение тех, которые не влияют на предсказываемую величину;
* Подбор параметров модели 
* Опробованы различные алгоритмы и библиотека ML - PyCaret
* Опробованы Ансамбль моделей: Blending, Bagging, Bosting, Stacking


## Выводы

Было создано достаточно много новых признаков, некоторые из которых имеют очень высокую корреляцию Пирсона. Тем не менее удаление сильно коррелируемых признаков в ручную или с помощью алгоритма RFE немного но ухудшало метрику, также у kaggle часто не хватает памяти на это. Поэтому данный шаг считаю можно отсавить на будущее, когда уже модель пойдет в продакш и будет важна ее скорость.

Среди всех опробованных мною алгоритмов и ансамблей моделей, наилучший результат в лидерборде дал CatBoostRegressor без подобранных параметров.

Так как обучающая и тестовая выборка были сделаны в разное время, для цены был применен поправочный кэффициент 0.895.
Точность модели по метрике MAPE: 12.74%, а в лидербоде удалось выбить **15.36795 (64 место)**.

Так же была применения идея вычисления спроса автомобилей у которых нет цены (проданы), идея хорошая но метрику она не улучшила.

Задача очень интересная и практико-орентированная.
